library(help = "datasets")
data(sleep)
str(sleep)
str(trees)
str(volcano)
str(WWWusage)
str(Orange)
View(Orange)
hist(Orange$age)
setwd("f:/Work/R/Titanic/")
library(dplyr)
library(ggplot2)
data <- read.csv("train.csv", header = TRUE)
g <- ggplot(data, aes(survived))
g <- g + geom_histogram()
g
g <- ggplot(data, aes(Survived))
g <- g + geom_histogram()
g
g <- ggplot(data, aes(as.factor(Survived)))
g <- g + geom_histogram()
g
g <- ggplot(data, aes(as.factor(Survived)))
g <- g + geom_histogram(stats = "count")
g
g <- ggplot(data, aes(as.factor(Survived)))
g <- g + geom_histogram(stat = "count")
g
g <- ggplot(data, aes(as.factor(Survived)))
g <- g + geom_bar(stat = "count")
g
g <- ggplot(data, aes(as.factor(Survived)))
g <- g + geom_bar(stat = "count", colours = Sex)
g
g <- ggplot(data, aes(as.factor(Survived), colours = Sex))
g <- g + geom_bar(stat = "count")
g
g <- ggplot(data, aes(as.factor(Survived)))
g <- g + geom_bar(stat = "count", fill = Sex)
g
g <- ggplot(data, aes(as.factor(Survived)))
g <- g + geom_bar(stat = "count", aes(fill = Sex))
g
g <- ggplot(data, aes(as.factor(Survived)))
g <- g + geom_bar(stat = "count", aes(fill = Sex), position = position_dodge())
g
data <- data %>%
mutate(Board = as.factor(substr(as.character(Cabin), 0, 1)))
head(data)
g <- ggplot(data, aes(as.factor(Survived)))
g <- g + geom_bar(stat = "count", aes(fill = Board), position = position_dodge())
g
g <- ggplot(data, aes(as.factor(Board)))
g <- g + geom_bar(stat = "count", aes(fill = Survived), position = position_dodge())
g
g <- ggplot(data, aes(as.factor(Board)))
g <- g + geom_bar(stat = "count", aes(fill = as.factor(Survived)), position = position_dodge())
g
g <- ggplot(data, aes(as.factor(Board)))
g <- g + geom_bar(stat = "count", aes(fill = as.factor(Survived)), position = position_dodge())
g <- g + ylim(0,100)
g
g <- ggplot(data, aes(as.factor(Board)))
g <- g + geom_bar(stat = "count", aes(fill = as.factor(Survived)), position = position_dodge())
g
data <- read.csv("train.csv", header = TRUE)
data <- data %>%
mutate(Deck = as.factor(substr(as.character(Cabin), 0, 1)))
g <- ggplot(data, aes(as.factor(Deck)))
g <- g + geom_bar(stat = "count", aes(fill = as.factor(Survived)), position = position_dodge())
g <- g + ylim(0,100)
g
g <- ggplot(data, aes(as.factor(Deck)))
g <- g + geom_bar(stat = "count", aes(fill = as.factor(Survived)), position = position_dodge())
g
g <- ggplot(data, aes(as.factor(Deck)))
g <- g + geom_bar(stat = "count", aes(fill = as.factor(Survived)), position = position_dodge())
g <- g + ylim(0,100)
g
head(data)
# Proportions of survived to non-survived for each deck
temp <- data %>%
mutate(NonSurvived = Survived == 0) %>%
transmute(Survived = Survived == 1) %>%
group_by(Deck) %>%
summarize(TotalSurvived = sum(Survived), TotalNonSurvived = sum(NonSurvived) ) %>%
mutate(Ratio = TotalSurvived / TotalNonSurvived)
# Proportions of survived to non-survived for each deck
temp <- data %>%
mutate(NonSurvived = Survived == 0) %>%
transmute(Survived = Survived == 1) %>%
summarize(group_by(Deck), TotalSurvived = sum(Survived), TotalNonSurvived = sum(NonSurvived) ) %>%
mutate(Ratio = TotalSurvived / TotalNonSurvived)
# Proportions of survived to non-survived for each deck
temp <- data %>%
mutate(NonSurvived = Survived == 0) %>%
transmute(Survived = Survived == 1) %>%
summarise(group_by(Deck), TotalSurvived = sum(Survived), TotalNonSurvived = sum(NonSurvived) ) %>%
mutate(Ratio = TotalSurvived / TotalNonSurvived)
head(data)
temp <- data %>%
mutate(NonSurvived = Survived == 0) %>%
transmute(Survived = Survived == 1)
head(tmp)
head(temp)
# Proportions of survived to non-survived for each deck
temp <- data %>%
mutate(NonSurvived = Survived == 0) %>%
mutate(Survived = Survived == 1) %>%
group_by(Deck) %>%
summarise(TotalSurvived = sum(Survived), TotalNonSurvived = sum(NonSurvived) ) %>%
mutate(Ratio = TotalSurvived / TotalNonSurvived)
head(temp)
g <- ggplot(data, aes(as.factor(Deck)))
g <- g + geom_bar(stat = "count", aes(fill = as.factor(Survived)), position = position_dodge())
g
g <- ggplot(temp, aes(Deck))
g <- g + geom_bar()
g
g <- ggplot(temp, aes(Deck, Ratio))
g <- g + geom_bar()
g
g <- ggplot(temp, aes(Deck, Ratio))
g <- g + geom_bar( stat = "bin" )
g
g <- ggplot(temp, aes(Deck, Ratio))
g <- g + geom_bar( stat = "identity" )
g
g <- ggplot(temp, aes(Deck, Ratio))
g <- g + geom_bar( stat = "identity", aes(fill = Ration > 1) )
g
g <- ggplot(temp, aes(Deck, Ratio))
g <- g + geom_bar( stat = "identity", aes(fill = Ratio > 1) )
g
temp
temp <- data %>%
mutate(HasCabin = grepl("[:digit]", Cabin))
head(temp)
temp <- data %>%
mutate(HasCabin = grepl("[:digit:]", Cabin))
head(temp)
temp <- data %>%
mutate(HasCabin = grepl("[0-9]+", Cabin))
head(temp)
data <- data %>%
mutate(HasCabin = grepl("[0-9]+", Cabin))
g <- ggplot(data, aes(as.factor(HasCabin)))
g <- g + geom_bar(stat = "count", aes(fill = as.factor(Survived)), position = position_dodge())
g
g <- ggplot(data, aes(Age))
g <- g + geom_boxplot()
g
g <- ggplot(data, aes(Age, group = Survived))
g <- g + geom_boxplot()
g
g <- ggplot(data, aes(Age))
g <- g + geom_boxplot(aes(group = Survived))
g
g <- ggplot(data, aes(as.factor(Survived), Age))
g <- g + geom_boxplot()
g
g <- ggplot(data, aes(as.factor(Survived), Age))
g <- g + geom_boxplot(colour = Survided)
g
g <- ggplot(data, aes(as.factor(Survived), Age))
g <- g + geom_boxplot(aes(colour = Survided))
g
g <- ggplot(data, aes(as.factor(Survived), Age))
g <- g + geom_boxplot(aes(colour = Survived))
g
g <- ggplot(data, aes(as.factor(Survived), Age))
g <- g + geom_boxplot(aes(colour = as.factor(Survived)))
g
fit <- lm(Survived ~ Age, data)
plot(fit)
plot(fit)
fit <- lm(Survived ~ Age, data)
summary(fit)
fit <- lm(Survived ~ Age - 1, data)
summary(fit)
plot(fit)
fit <- glm(Survived ~ Age, data, family = "binomial")
summary(fit)
fit <- glm(Survived ~ Age - 1, data, family = "binomial")
summary(fit)
plot(fit)
cor(data$Survived, data$Age)
cor(data$Survived, data$Age, na.rm = TRUE)
data <- data %>%
mutate(AgeGroup = cut(Age, breaks = 5))
summary(data$AgeGroup)
levels(data$AgeGroup)
levels(data$AgeGroup) <- c( levels(data$AgeGroup), "Missing")
summary(data$AgeGroup)
data$AgeGroup[is.na(data$AgeGroup)] <- "Missing"
summary(data$AgeGroup)
temp <- data %>%
mutate(NonSurvived = Survived == 0) %>%
mutate(Survived = Survived == 1) %>%
group_by(AgeGroup) %>%
summarise(TotalSurvived = sum(Survived), TotalNonSurvived = sum(NonSurvived) ) %>%
mutate(Ratio = TotalSurvived / TotalNonSurvived)
g <- ggplot(temp, aes(AgeGroup, Ratio))
g <- g + geom_bar( stat = "identity", aes(fill = Ratio > 1) )
g
head(data)
g <- ggplot(data, aes(as.factor(PClass)))
g <- g + geom_bar(stat = "count", aes(fill = as.factor(Survived)), position = position_dodge())
g
g <- ggplot(data, aes(as.factor(Pclass)))
g <- g + geom_bar(stat = "count", aes(fill = as.factor(Survived)), position = position_dodge())
g
g <- ggplot(data, aes(SibSp, Parch))
g <- g + geom_point(colours = as.factor(Survived))
g
g <- ggplot(data, aes(SibSp, Parch))
g <- g + geom_point()
g
g <- ggplot(data, aes(SibSp, Parch))
g <- g + geom_jitter()
g
g <- ggplot(data, aes(SibSp, Parch))
g <- g + geom_jitter(aes(color = as.factor(Survived)))
g
temp <- data %>%
filter(SibSp == 0 & Parch == 0)
g <- ggplot(data, aes(as.factor(Survived)))
g <- g + geom_bar(stat = "count")
g
g <- ggplot(data, aes(Age))
g <- g + geom_density()
g
data <- data %>%
mutate(Family = SibSp + Parch)
data = select(data, -Family)
head(data)
data <- data %>%
mutate(Family = SibSp + Parch, IsFamily = Family > 0)
head(data)
g <- ggplot(data, aes(Age))
g <- g + geom_density(aes(color = IsFamily))
g
g <- ggplot(data, aes(Age))
g <- g + geom_density(aes(color = IsFamily))
g <- g + geom_bar(stat = "count", aes(fill = IsFamily))
g
g <- ggplot(data, aes(Age))
g <- g + geom_bar(stat = "count", aes(fill = IsFamily))
g
g <- ggplot(data, aes(AgeGroup))
g <- g + geom_bar(stat = "count", aes(fill = IsFamily))
g
g <- ggplot(data, aes(Sex))
g <- g + geom_bar(stat = "count", aes(fill = IsFamily))
g
